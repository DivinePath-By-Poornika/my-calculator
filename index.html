<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Divine Path ‚Ä¢ Tarot & Numerology by Poonam</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#0b0d10;
    --bg-2:#0d1016;
    --card:#11141aee;
    --muted:#9aa3af;
    --text:#e7e9ee;
    --brand:#ffd166;
    --brand-2:#8ec5ff;
    --accent:#e08cff;
    --ok:#4ade80;
    --warn:#f59e0b;
    --err:#ef4444;
    --radius:18px;
    --shadow: 0 10px 30px rgba(0,0,0,.45);
    --glass: blur(12px) saturate(140%);
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    color:var(--text);
    background:
      radial-gradient(1200px 800px at 10% -10%, #1b2230 0%, transparent 60%),
      radial-gradient(900px 600px at 90% 10%, #261a3a 0%, transparent 60%),
      linear-gradient(180deg,#0b0d10 0%, #0b0d10 100%);
    background-attachment: fixed;
  }

  /* NAV */
  .nav{
    position:sticky; top:0; z-index:100;
    backdrop-filter:var(--glass);
    background: linear-gradient(180deg, #0b0d10cc, #0b0d10aa);
    border-bottom:1px solid #1f2530;
  }
  .nav .wrap{
    max-width:1200px; margin:auto; padding:14px 20px;
    display:flex; align-items:center; justify-content:space-between; gap:16px;
  }
  .brand{
    font-family:"Playfair Display",serif;
    font-weight:700; letter-spacing:.5px; color:var(--brand);
    display:flex; align-items:center; gap:.6rem;
  }
  .brand .dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 16px var(--accent)}
  .nav a{color:var(--text);text-decoration:none;font-weight:600;opacity:.9}
  .nav ul{display:flex;gap:22px;list-style:none}
  .nav a:hover{color:var(--brand)}
  .nav .right{display:flex;align-items:center;gap:10px}

  /* GLASSY BUTTONS */
  .btn, .ghost{
    position:relative; isolation:isolate;
    display:inline-flex; align-items:center; gap:.55rem;
    padding:.9rem 1.15rem; border-radius:999px; text-decoration:none;
    font-weight:800; transform:translateY(0) scale(1); transition:.35s ease;
    box-shadow:0 10px 24px rgba(0,0,0,.35);
    overflow:hidden; backdrop-filter: var(--glass);
    cursor:pointer; user-select:none;
  }
  .btn{
    background:linear-gradient(135deg, #ffffff33, #ffffff12),
               radial-gradient(60% 120% at 20% 0%, var(--brand) 0%, #ff9f4d 55%, #ff7b33 100%);
    color:#272316; border:1px solid #ffffff55;
  }
  .ghost{
    background:linear-gradient(135deg,#1a2030aa,#0f1320aa);
    color:#c7ceda; border:1px solid #3a455c;
  }
  .btn::before, .ghost::before{
    content:""; position:absolute; inset:auto auto 8% 10%; width:86%; height:42%;
    background:radial-gradient(120% 120% at 50% 0%, #ffffff80 0%, #ffffff10 55%, transparent 70%);
    border-radius:999px; filter:blur(2px); opacity:.7; pointer-events:none;
    transform:translateY(0); transition:transform .35s ease,opacity .35s ease;
  }
  .btn::after, .ghost::after{
    content:""; position:absolute; top:10%; right:12%; width:18px; height:18px; border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #fff8 0%, #fff2 45%, #fff0 70%);
    box-shadow:inset 0 0 10px #fff3, 0 8px 14px #0004; filter:blur(.2px);
    animation:float 3.2s ease-in-out infinite;
  }
  .btn:hover, .ghost:hover{ transform:translateY(-3px) scale(1.02); box-shadow:0 16px 28px rgba(0,0,0,.45)}
  .btn:active, .ghost:active{ transform:translateY(0) scale(.99) }
  .btn:hover::before, .ghost:hover::before{ transform:translateY(-3px); opacity:.9 }

  @keyframes float{ 0%,100%{ transform:translateY(0)} 50%{ transform:translateY(-6px)} }

  /* HERO */
  .hero{
    position:relative; overflow:hidden;
    display:grid; place-items:center; text-align:center;
    min-height:88vh;
  }
  .hero .stars{position:absolute; inset:-20% -10%; background:url('https://images.unsplash.com/photo-1543722530-d2c3201371e7?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat; filter:brightness(.32) contrast(1.05) saturate(1.05); transform:scale(1.05)}
  .hero .veil{position:absolute; inset:0; background:radial-gradient(60% 60% at 50% 40%, #0000 0%, #0b0d10 90%)}
  .hero .content{position:relative; padding:0 20px; max-width:980px; animation:fadeUp .9s ease both}
  .kicker{
    color:var(--brand); font-weight:700; letter-spacing:.18em; text-transform:uppercase; font-size:.82rem; opacity:.9
  }
  .h1{
    font-family:"Playfair Display",serif; font-size:clamp(2.4rem,5vw,3.6rem);
    line-height:1.1; margin:.6rem 0 1rem;
    text-shadow:0 10px 30px rgba(0,0,0,.6);
  }
  .sub{
    max-width:720px; margin:auto; color:var(--muted);
    font-size:1.05rem
  }
  .hero .cta{margin-top:1.8rem; gap:12px; display:flex; justify-content:center; flex-wrap:wrap}

  /* SECTION WRAPPER */
  .section{max-width:1200px; margin:90px auto; padding:0 20px}
  .section h2{
    font-family:"Playfair Display",serif; font-size:clamp(1.8rem,3.2vw,2.4rem);
    margin-bottom:14px
  }
  .lead{color:var(--muted)}

  /* CARDS / GLASS CONTAINERS */
  .card{
    background:linear-gradient(180deg, var(--card), #0f1320ee);
    border:1px solid #1f2530; border-radius:var(--radius); box-shadow:var(--shadow);
    padding:24px
  }
  .imgcard{
    position:relative; overflow:hidden;
    background:linear-gradient(180deg,#0d111b,#0f1320); border:1px solid #1f2530;
    border-radius:var(--radius); box-shadow:var(--shadow); padding:14px
  }
  .imgcard img{width:100%; height:auto; border-radius:calc(var(--radius) - 8px); display:block; filter:saturate(1.05) contrast(1.02)}
  .imgcard::after{content:""; position:absolute; inset:6px; border-radius:calc(var(--radius) - 8px); pointer-events:none; box-shadow:inset 0 0 0 1px #ffffff10}

  /* GRID */
  .grid{ display:grid; gap:26px; align-items:start }
  @media (min-width:980px){ .grid-2{grid-template-columns:1.15fr .85fr} }
  .services{display:grid; gap:22px; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); margin-top:18px}
  .service{
    position:relative; overflow:hidden;
    background:linear-gradient(160deg,#121725,#0f1320);
    border:1px solid #21293a; border-radius:16px; padding:22px 20px;
    transition:.35s ease; box-shadow:0 6px 18px rgba(0,0,0,.25)
  }
  .service:hover{transform:translateY(-6px) rotateX(2deg); box-shadow:0 14px 28px rgba(0,0,0,.35); border-color:#2a3550}
  .service .tag{
    background:linear-gradient(135deg,var(--brand-2),var(--accent));
    color:#0a0e14; font-weight:800; font-size:.8rem;
    border-radius:999px; padding:.28rem .6rem; display:inline-block; margin-bottom:10px
  }
  .service h3{margin:.25rem 0 .5rem; font-size:1.05rem}
  .service p{color:var(--muted); font-size:.95rem}

  /* TABS / SWITCHER */
  .tabs{display:flex; gap:8px; flex-wrap:wrap; margin:12px 0 18px}
  .chip{
    padding:.55rem .9rem; border-radius:999px; border:1px solid #2a3550;
    background:linear-gradient(135deg,#0f1320bb,#0a0e18bb); color:#c8d2e8; font-weight:700;
    cursor:pointer; user-select:none; transition:.25s; box-shadow:0 6px 18px rgba(0,0,0,.25)
  }
  .chip[aria-pressed="true"]{border-color:var(--brand); color:#1b1306; background:linear-gradient(135deg,#ffe8b0,#ffdd77)}

  /* TAROT TABLE */
  .table-area{
    position:relative; overflow:hidden;
    background:
      radial-gradient(800px 400px at 10% -10%, #172238 0%, transparent 60%),
      radial-gradient(700px 400px at 90% 0%, #2a1a3a 0%, transparent 60%),
      linear-gradient(180deg,#0b0e14,#0b0e14);
    border-radius:20px; border:1px solid #1f2530; padding:22px;
    box-shadow:0 10px 28px rgba(0,0,0,.3), inset 0 0 60px #0007;
  }
  .spread{display:flex; gap:14px; flex-wrap:wrap; justify-content:center; perspective:1200px; min-height:220px}
  .tarot-card{
    width:120px; height:200px; border-radius:14px; position:relative;
    transform-style:preserve-3d; transition:transform .8s cubic-bezier(.2,.8,.2,1), filter .4s;
    cursor:pointer; user-select:none;
  }
  .tarot-card:hover{filter:brightness(1.06)}
  .tarot-card .side{
    position:absolute; inset:0; border-radius:14px;
    backface-visibility:hidden; overflow:hidden; border:1px solid #263049;
    box-shadow:0 10px 24px #0008, inset 0 0 0 1px #ffffff10;
  }
  .tarot-card .back{
    background:
      repeating-conic-gradient(from 0deg, #1a2134 0 18deg, #15203a 18deg 36deg),
      linear-gradient(120deg,#223 10%,#112 90%);
    display:grid; place-items:center;
  }
  .sigil{width:64px; height:64px; border-radius:50%;
    background:radial-gradient(circle at 30% 30%, #ffe6 0%, #ffd1 45%, #0000 70%);
    box-shadow:0 0 22px #ffd16655, inset 0 0 14px #ffd16688;
  }
  .tarot-card .front{
    background:
      radial-gradient(600px 260px at 50% -20%, #ffffff18 0%, #ffffff08 55%, transparent 70%),
      linear-gradient(180deg,#0f1422,#0f1422);
    transform:rotateY(180deg);
    display:flex; flex-direction:column; justify-content:flex-end;
    padding:10px; gap:8px;
  }
  .front .title{font-weight:800; font-size:.95rem; letter-spacing:.3px}
  .front .kw{font-size:.82rem; color:#c3cbe0}
  .front .illust{
    position:absolute; inset:8px; border-radius:12px; opacity:.95; mix-blend-mode:screen;
    background: radial-gradient(380px 200px at 50% 20%, #e08cff38 0%, transparent 65%),
                radial-gradient(380px 200px at 40% 60%, #8ec5ff28 0%, transparent 65%),
                radial-gradient(380px 200px at 60% 70%, #ffd1662a 0%, transparent 65%);
    pointer-events:none;
  }
  .tarot-card.flipped{ transform:rotateY(180deg) translateY(-6px) }
  .tarot-card .shine{
    content:""; position:absolute; inset:-40% -40% auto auto; width:160%; height:160%;
    transform:rotate(25deg); background:linear-gradient(120deg,transparent 40%, #ffffff08 55%, transparent 70%);
    pointer-events:none; transition:transform .6s ease;
  }
  .tarot-card:hover .shine{ transform: rotate(25deg) translateY(-18px) }

  .question-row{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
  .input{
    flex:1; min-width:220px; background:#0d1118; border:1px solid #223; color:#cfe2ff;
    padding:.9rem 1rem; border-radius:12px; outline:none; transition:.25s; font-weight:600
  }
  .input:focus{border-color:#3a5fb2; box-shadow:0 0 0 3px #3a5fb233}

  /* PANELS */
  .panel{display:grid; gap:14px}
  .panel-2{display:grid; grid-template-columns:1.1fr .9fr; gap:14px}
  @media (max-width:980px){ .panel-2{grid-template-columns:1fr} }

  .pill{ display:inline-block; padding:.4rem .7rem; border:1px solid #2a3350; border-radius:999px; color:#cbd3e6; font-size:.8rem; margin-bottom:10px }

  /* CONTACT */
  .contact{ display:grid; gap:22px; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); margin-top:18px }
  .contact a{ text-decoration:none; color:var(--text) }
  .contact .tile{
    background:linear-gradient(160deg,#121725,#0f1320); border:1px solid #21293a;
    border-radius:16px; padding:18px; transition:.3s ease; box-shadow:0 6px 18px rgba(0,0,0,.25)
  }
  .contact .tile:hover{transform:translateY(-6px); border-color:#2a3550}
  .contact .k{opacity:.8; font-weight:700; letter-spacing:.1em; text-transform:uppercase; font-size:.72rem; color:#b7c0d6}
  .contact .v{font-size:1.05rem; font-weight:700}

  /* FOOTER */
  footer{margin-top:80px; padding:26px 16px; text-align:center; color:#a9b3c9; border-top:1px solid #1f2530}

  /* REVEAL ANIMS */
  [data-reveal]{opacity:0; transform:translateY(14px); transition:opacity .7s ease, transform .7s ease}
  [data-reveal].show{opacity:1; transform:none}
  @keyframes fadeUp{from{opacity:0; transform:translateY(18px)} to{opacity:1; transform:none}}

  /* UTIL */
  .center{text-align:center}
  .muted{color:#b5bfd6}
  .ok{color:var(--ok)} .warn{color:var(--warn)} .err{color:var(--err)}
  .small{font-size:.86rem}

  /* SPARKLES */
  .sparkle{ position:absolute; width:6px; height:6px; border-radius:50%;
    background:radial-gradient(circle,#fff 0%, #fff0 70%); pointer-events:none; mix-blend-mode:screen;
    animation:spark .9s ease-out forwards
  }
  @keyframes spark{
    from{ transform:translate(var(--sx,0), var(--sy,0)) scale(1); opacity:1}
    to{ transform:translate(calc(var(--sx,0)*5), calc(var(--sy,0)*5)) scale(0); opacity:0}
  }

  /* RESULT BOXES */
  .result{
    background:linear-gradient(180deg,#0f1320,#0c111b); border:1px solid #22304a; border-radius:16px; padding:14px 16px;
  }
  .result h4{margin:0 0 4px; font-size:1rem}
  .result p{margin:.2rem 0; color:#cfd8ee; line-height:1.55}
  .code{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size:.86rem; background:#111726; border:1px solid #26304a; padding:8px 10px; border-radius:8px; color:#c9d7ff}
</style>
</head>
<body>

  <!-- NAV -->
  <header class="nav">
    <div class="wrap">
      <div class="brand"><span class="dot"></span> Divine Path</div>
      <nav aria-label="Primary">
        <ul>
          <li><a href="#home">Home</a></li>
          <li><a href="#tarot">Tarot</a></li>
          <li><a href="#numerology">Numerology</a></li>
          <li><a href="#astro">Astrology</a></li>
          <li><a href="#ai">Online AI</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </nav>
      <div class="right">
        <a class="ghost" href="#tarot" aria-label="Try a reading">Start Reading ‚ú®</a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section id="home" class="hero" aria-label="Welcome">
    <div class="stars" aria-hidden="true"></div><div class="veil" aria-hidden="true"></div>
    <div class="content">
      <div class="kicker">Guided by Tarot ‚Ä¢ Blessed by the Divine</div>
      <h1 class="h1">Walk the Divine Path</h1>
      <p class="sub">‚ÄúTarot is not about predicting fate‚Äîit‚Äôs about reading the energy of the moment and making aligned choices. Let the cards, numbers and stars illuminate your way.‚Äù</p>
      <div class="cta">
        <a class="btn" href="#tarot">Explore Tarot</a>
        <a class="ghost" href="#numerology">Your Numbers</a>
        <a class="ghost" href="#astro">Astrology</a>
      </div>
    </div>
  </section>

  <!-- TAROT -->
  <section id="tarot" class="section">
    <h2 data-reveal>Tarot Readings ‚ú®</h2>
    <p class="lead" data-reveal>Expressive, question-aware draws with immersive animations & real-feel sound.</p>

    <div class="card panel-2" data-reveal>
      <div>
        <div class="pill">Ask a Question</div>
        <div class="question-row">
          <input id="question" class="input" placeholder="e.g., Love ka future? Career decision? Next 3 months?" />
          <button id="drawBtn" class="btn">Draw Cards</button>
          <button id="resetBtn" class="ghost">Reset</button>
        </div>

        <div class="tabs" role="tablist" aria-label="Choose spread">
          <button class="chip" data-spread="1" aria-pressed="false">Single Insight</button>
          <button class="chip" data-spread="3" aria-pressed="true">3-Card (Past/Present/Future)</button>
          <button class="chip" data-spread="5" aria-pressed="false">5-Card Guidance</button>
          <button class="chip" data-spread="7" aria-pressed="false">Horseshoe (7)</button>
          <button class="chip" data-spread="celtic" aria-pressed="false">Celtic Cross (10)</button>
        </div>

        <div class="table-area">
          <div id="spread" class="spread" aria-live="polite"></div>
        </div>

        <div id="reading" class="result" style="margin-top:14px; display:none">
          <h4>Reading Summary</h4>
          <p id="readingText"></p>
        </div>
      </div>

      <div>
        <div class="pill">Mode</div>
        <div class="tabs" role="tablist" aria-label="Online or Offline">
          <button class="chip" id="mode-offline" aria-pressed="true">Offline (Instant)</button>
          <button class="chip" id="mode-online" aria-pressed="false">Online AI (Optional)</button>
        </div>

        <div class="result small">
          <h4>How it works</h4>
          <p>‚Ä¢ Offline: symbolic logic + question-aware keywords (no internet needed).</p>
          <p>‚Ä¢ Online: optional webhook to any AI endpoint (OpenRouter/Cloudflare/OpenAI proxy etc.). Fallback = offline.</p>
        </div>

        <div class="card" style="margin-top:12px">
          <div class="pill">Online AI Settings (Optional)</div>
          <label class="small" for="apiUrl">AI Endpoint URL</label>
          <input id="apiUrl" class="input" placeholder="https://your-ai-endpoint.example.com" />
          <div class="question-row">
            <input id="apiKey" class="input" placeholder="API Key (if needed)" />
            <button id="testApi" class="ghost">Test AI</button>
          </div>
          <div id="apiStatus" class="small muted" aria-live="polite">Status: Offline mode active.</div>
        </div>

        <div class="result small" style="margin-top:12px">
          <h4>Tip</h4>
          <p>Jo spread chaho choose karo, question likho, ‚ÄúDraw Cards‚Äù dabao. Har card pe tap/hover se flip hoga aur meaning dikhega. Sounds included üéµ</p>
        </div>
      </div>
    </div>
  </section>

  <!-- NUMEROLOGY -->
  <section id="numerology" class="section">
    <h2 data-reveal>Numerology Calculators üî¢</h2>
    <p class="lead" data-reveal>Life Path, Expression, Soul Urge, Personality, Destiny, Maturity, Birthday, Karmic Debts, Balance, Personal Year, Pinnacles & Challenges‚Äîsab ek jagah.</p>

    <div class="card panel" data-reveal>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:14px">
        <div>
          <div class="pill">Your Details</div>
          <label class="small" for="fullName">Full Name (as on records)</label>
          <input id="fullName" class="input" placeholder="e.g., Poonam Kumari" />
        </div>
        <div>
          <div class="pill">&nbsp;</div>
          <label class="small" for="dob">Date of Birth</label>
          <input id="dob" class="input" type="date" />
        </div>
        <div style="display:flex;align-items:flex-end">
          <button id="calcNum" class="btn">Calculate</button>
          <button id="resetNum" class="ghost" style="margin-left:8px">Reset</button>
        </div>
      </div>

      <div id="numResults" class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:14px; margin-top:8px"></div>

      <div id="luckyBox" class="result" style="display:none; margin-top:10px">
        <h4>Lucky Elements</h4>
        <p id="luckyText"></p>
      </div>
    </div>
  </section>

  <!-- ASTRO -->
  <section id="astro" class="section">
    <h2 data-reveal>Astrology (Lite) ‚ú®</h2>
    <p class="lead" data-reveal>Quick Sun sign, cycles & a simplified Dasha-style timeline (offline). Detailed Vedic requires exact birth data & ephemeris‚Äîiss version me placeholder-style guidance diya gaya hai.</p>

    <div class="card panel" data-reveal>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:14px">
        <div>
          <div class="pill">Basic</div>
          <label class="small" for="astroDob">Date of Birth</label>
          <input id="astroDob" class="input" type="date" />
        </div>
        <div>
          <div class="pill">&nbsp;</div>
          <label class="small" for="astroTime">Time (optional)</label>
          <input id="astroTime" class="input" type="time" />
        </div>
        <div>
          <div class="pill">&nbsp;</div>
          <label class="small" for="astroPlace">Place (optional)</label>
          <input id="astroPlace" class="input" placeholder="City, Country" />
        </div>
        <div style="display:flex;align-items:flex-end">
          <button id="calcAstro" class="btn">Get Insights</button>
          <button id="resetAstro" class="ghost" style="margin-left:8px">Reset</button>
        </div>
      </div>

      <div id="astroResults" class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:14px; margin-top:10px"></div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="section">
    <h2 data-reveal>Let‚Äôs Connect ‚ú®</h2>
    <p class="lead" data-reveal>Your answers are waiting to be revealed. Book your Tarot session today.</p>
    <div class="contact">
      <a href="mailto:divinepath743@gmail.com" class="tile" data-reveal>
        <div class="k">Email</div>
        <div class="v">divinepath743@gmail.com</div>
      </a>
      <a href="https://wa.me/919835230370" target="_blank" rel="noopener" class="tile" data-reveal>
        <div class="k">WhatsApp</div>
        <div class="v">+91 9835230370</div>
      </a>
      <a href="https://instagram.com/punamtarotcardreader" target="_blank" rel="noopener" class="tile" data-reveal>
        <div class="k">Social</div>
        <div class="v">@punamtarotcardreader</div>
      </a>
    </div>
    <div class="center" style="margin-top:22px" data-reveal>
      <a class="ghost" href="#home">Back to top ‚Üë</a>
    </div>
  </section>

  <footer>
    Guidance through Tarot, Blessings through the Divine ‚Ä¢ ¬© 2025 Poonam/Poornika ‚Äî All Rights Reserved ‚Ä¢ Built with ‚ù§Ô∏è
  </footer>

<script>
/* ========= UTIL: Reveal on scroll, parallax, sparkles, haptics ========= */
const io = new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(e.isIntersecting){ e.target.classList.add('show'); io.unobserve(e.target); }
  })
},{threshold:.14});
document.querySelectorAll('[data-reveal]').forEach(el=>io.observe(el));

const stars = document.querySelector('.hero .stars');
window.addEventListener('mousemove', (e)=>{
  const x = (e.clientX / window.innerWidth - .5) * 8;
  const y = (e.clientY / window.innerHeight - .5) * 8;
  if(stars) stars.style.transform = `scale(1.06) translate(${x}px, ${y}px)`;
});

const shimmers = document.querySelectorAll('.btn, .ghost, .chip');
shimmers.forEach(btn=>{
  btn.addEventListener('pointermove', (e)=>{
    const rect = btn.getBoundingClientRect();
    const x = e.clientX - rect.left; const y = e.clientY - rect.top;
    btn.style.setProperty('--mx', x + 'px');
    btn.style.setProperty('--my', y + 'px');
  });
  btn.addEventListener('click', ()=>tryVibrate(10));
});

function sparkAt(el, x, y){
  const s = document.createElement('span');
  s.className = 'sparkle';
  const rx = (Math.random()-.5)*2, ry = (Math.random()-.5)*2;
  s.style.left = x+'px'; s.style.top = y+'px';
  s.style.setProperty('--sx', rx);
  s.style.setProperty('--sy', ry);
  el.appendChild(s);
  setTimeout(()=>s.remove(), 900);
}

function tryVibrate(ms){ if('vibrate' in navigator) try{ navigator.vibrate(ms) }catch{} }

/* ========= SOUND: WebAudio tiny synth (no external files) ========= */
let audioCtx;
function ac(){ if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)(); return audioCtx }
function ping(freq=660, dur=.08, type='sine', gain=.12){
  const ctx = ac(); const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type=type; o.frequency.value=freq; o.connect(g); g.connect(ctx.destination);
  g.gain.value=gain; o.start();
  g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur);
  o.stop(ctx.currentTime + dur);
}
function chord(freqs=[440,554,659], dur=.18){
  const ctx = ac(); const master=ctx.createGain(); master.connect(ctx.destination); master.gain.value=.08;
  freqs.forEach((f,i)=>{
    const o = ctx.createOscillator(); const g = ctx.createGain();
    o.type='sine'; o.frequency.value=f; o.connect(g); g.connect(master);
    g.gain.value= .22/(i+1); o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur+.05*i);
    o.stop(ctx.currentTime + dur+.05*i);
  });
}
function shuffleSound(){
  const ctx = ac();
  const b = ctx.createBuffer(1, ctx.sampleRate*.25, ctx.sampleRate);
  const data = b.getChannelData(0);
  for(let i=0;i<data.length;i++){ data[i] = (Math.random()*2-1)*.25 * (1 - i/data.length); }
  const src = ctx.createBufferSource(); src.buffer=b;
  const g = ctx.createGain(); g.gain.value=.4;
  src.connect(g).connect(ctx.destination); src.start();
}
function flipSound(){ ping(720,.09,'triangle',.15); ping(540,.08,'sine',.08); }

/* ========= TAROT: Deck, keywords, spreads, logic ========= */
const DECK = [
  // Minimal curated set (add more easily). Major + sample minors with expressive emojis for clarity
  {name:"The Fool", arcana:"Major", keywords:["new beginnings","leap of faith","innocence"], upright:"+ Fresh start ‚Ä¢ Trust your path", reverse:"Recklessness ‚Ä¢ Hesitation", emoji:"üå±"},
  {name:"The Magician", arcana:"Major", keywords:["manifestation","skill","willpower"], upright:"+ You can make it happen", reverse:"Scattered energy", emoji:"ü™Ñ"},
  {name:"The High Priestess", arcana:"Major", keywords:["intuition","mystery"], upright:"+ Listen to inner voice", reverse:"Secrets, doubt", emoji:"üåô"},
  {name:"The Empress", arcana:"Major", keywords:["nurture","abundance"], upright:"+ Growth, care", reverse:"Smothering, delay", emoji:"üåæ"},
  {name:"The Emperor", arcana:"Major", keywords:["structure","leadership"], upright:"+ Boundaries, plan", reverse:"Rigidity", emoji:"üõ°Ô∏è"},
  {name:"The Hierophant", arcana:"Major", keywords:["tradition","learning"], upright:"+ Guidance, mentor", reverse:"Break from norm", emoji:"üìú"},
  {name:"The Lovers", arcana:"Major", keywords:["love","choices"], upright:"+ Union, harmony", reverse:"Misalignment", emoji:"üíû"},
  {name:"The Chariot", arcana:"Major", keywords:["will","victory"], upright:"+ Move forward", reverse:"Lack of control", emoji:"üöÄ"},
  {name:"Strength", arcana:"Major", keywords:["courage","patience"], upright:"+ Gentle power", reverse:"Self-doubt", emoji:"ü¶Å"},
  {name:"The Hermit", arcana:"Major", keywords:["soul-search","wisdom"], upright:"+ Inner guidance", reverse:"Isolation", emoji:"üèîÔ∏è"},
  {name:"Wheel of Fortune", arcana:"Major", keywords:["cycles","luck"], upright:"+ Turning point", reverse:"Resistance", emoji:"üé°"},
  {name:"Justice", arcana:"Major", keywords:["truth","karma"], upright:"+ Fairness", reverse:"Imbalance", emoji:"‚öñÔ∏è"},
  {name:"The Hanged Man", arcana:"Major", keywords:["pause","new view"], upright:"+ Surrender, insight", reverse:"Stuck", emoji:"üîÑ"},
  {name:"Death", arcana:"Major", keywords:["endings","rebirth"], upright:"+ Big transformation", reverse:"Clinging", emoji:"ü¶ã"},
  {name:"Temperance", arcana:"Major", keywords:["balance","healing"], upright:"+ Blend & heal", reverse:"Excess", emoji:"üïäÔ∏è"},
  {name:"The Devil", arcana:"Major", keywords:["attachments","shadow"], upright:"+ Face patterns", reverse:"Release", emoji:"‚õìÔ∏è"},
  {name:"The Tower", arcana:"Major", keywords:["sudden change"], upright:"+ Truth revealed", reverse:"Fear of change", emoji:"‚ö°"},
  {name:"The Star", arcana:"Major", keywords:["hope","renewal"], upright:"+ Blessings ahead", reverse:"Doubt", emoji:"‚≠ê"},
  {name:"The Moon", arcana:"Major", keywords:["unclear","fears"], upright:"+ Trust intuition", reverse:"Revealed", emoji:"üåò"},
  {name:"The Sun", arcana:"Major", keywords:["joy","success"], upright:"+ Yes, vitality", reverse:"Temporary cloud", emoji:"üåû"},
  {name:"Judgement", arcana:"Major", keywords:["awakening","calling"], upright:"+ Answer the call", reverse:"Self-criticism", emoji:"üì£"},
  {name:"The World", arcana:"Major", keywords:["completion","wholeness"], upright:"+ Graduation", reverse:"Loose ends", emoji:"üåç"},
  // Sample minors for more variety
  {name:"Ace of Cups", arcana:"Minor", suit:"Cups", keywords:["love","new feelings"], upright:"+ Open heart", reverse:"Blocked emotions", emoji:"ü´∂"},
  {name:"Two of Cups", arcana:"Minor", suit:"Cups", keywords:["union","harmony"], upright:"+ Partnership", reverse:"Disharmony", emoji:"ü•Ç"},
  {name:"Three of Swords", arcana:"Minor", suit:"Swords", keywords:["pain","truth"], upright:"+ Honest release", reverse:"Healing", emoji:"üíî"},
  {name:"Six of Wands", arcana:"Minor", suit:"Wands", keywords:["victory","recognition"], upright:"+ Win ahead", reverse:"Ego check", emoji:"üèÜ"},
  {name:"Eight of Pentacles", arcana:"Minor", suit:"Pentacles", keywords:["skill","work"], upright:"+ Mastery", reverse:"Burnout", emoji:"üîß"},
  {name:"Ten of Pentacles", arcana:"Minor", suit:"Pentacles", keywords:["legacy","family"], upright:"+ Security", reverse:"Strings attached", emoji:"üè†"},
  {name:"Ace of Swords", arcana:"Minor", suit:"Swords", keywords:["clarity","truth"], upright:"+ Clear decision", reverse:"Confusion", emoji:"üó°Ô∏è"},
  {name:"Page of Wands", arcana:"Minor", suit:"Wands", keywords:["spark","news"], upright:"+ Try it", reverse:"Restless", emoji:"üî•"},
  {name:"Queen of Cups", arcana:"Minor", suit:"Cups", keywords:["compassion","intuition"], upright:"+ Empathy", reverse:"Oversensitive", emoji:"üëë"},
  {name:"King of Pentacles", arcana:"Minor", suit:"Pentacles", keywords:["stability","abundance"], upright:"+ Build wealth", reverse:"Rigid", emoji:"üëëüí∞"}
];

const QUESTIONS = {
  love: ["love","relationship","marriage","partner","heart","breakup","compatibility","trust"],
  career: ["job","career","work","business","startup","offer","promotion","boss","office"],
  money: ["money","finance","income","salary","invest","debt","loan"],
  health: ["health","ill","wellness","disease","body"],
  spiritual: ["spiritual","soul","purpose","karma","healing","energy"]
};

const SPREADS = {
  "1": { count:1, labels:["Focus"] },
  "3": { count:3, labels:["Past","Present","Future"] },
  "5": { count:5, labels:["Situation","Block","Advice","External","Outcome"] },
  "7": { count:7, labels:["Past","Present","Hidden","Advice","Obstacle","Influence","Outcome"] },
  "celtic": { count:10, labels:["Significator","Crossing","Below","Behind","Above","Before","Self","Environment","Hopes/Fears","Outcome"] }
};

let currentSpread = "3";
let onlineMode = false;

document.querySelectorAll('.chip[data-spread]').forEach(ch=>{
  ch.addEventListener('click', ()=>{
    document.querySelectorAll('.chip[data-spread]').forEach(c=>c.setAttribute('aria-pressed','false'));
    ch.setAttribute('aria-pressed','true');
    currentSpread = ch.getAttribute('data-spread');
    renderEmptySpread();
  })
});

document.getElementById('mode-offline').addEventListener('click', ()=>{
  document.getElementById('mode-offline').setAttribute('aria-pressed','true');
  document.getElementById('mode-online').setAttribute('aria-pressed','false');
  onlineMode = false; setApiStatus('Status: Offline mode active.');
});
document.getElementById('mode-online').addEventListener('click', ()=>{
  document.getElementById('mode-offline').setAttribute('aria-pressed','false');
  document.getElementById('mode-online').setAttribute('aria-pressed','true');
  onlineMode = true; setApiStatus('Status: Online mode selected (will fallback to offline if request fails).');
});

function setApiStatus(t){ const s = document.getElementById('apiStatus'); if(s){ s.textContent = t } }

document.getElementById('testApi').addEventListener('click', async ()=>{
  try{
    const url = document.getElementById('apiUrl').value.trim();
    if(!url){ setApiStatus('Please enter a valid endpoint URL.'); ping(220,.15,'sine',.2); return; }
    setApiStatus('Testing endpoint...');
    // harmless HEAD/GET attempt (some endpoints might block). We just check reachability.
    const res = await fetch(url, { method:'GET', mode:'cors' }).catch(()=>null);
    if(res && (res.ok || res.status<500)){ setApiStatus('Reachable ‚úÖ (Ensure your endpoint accepts POST JSON for readings).'); chord([523,659,784],.2) }
    else { setApiStatus('Not reachable or blocked by CORS. It may still work on your domain/server.'); ping(200,.2,'sine',.15) }
  }catch(e){ setApiStatus('Test failed (CORS or network). Offline still works.'); ping(200,.2,'sine',.15) }
});

function renderEmptySpread(){
  const spec = SPREADS[currentSpread];
  const container = document.getElementById('spread');
  container.innerHTML = '';
  for(let i=0;i<spec.count;i++){
    const c = createCardShell(spec.labels[i]||`Card ${i+1}`);
    container.appendChild(c);
  }
}
function createCardShell(label){
  const card = document.createElement('div'); card.className='tarot-card';
  const back = document.createElement('div'); back.className='side back';
  const sig = document.createElement('div'); sig.className='sigil';
  back.appendChild(sig);
  const front = document.createElement('div'); front.className='side front';
  const ill = document.createElement('div'); ill.className='illust'; front.appendChild(ill);
  const t = document.createElement('div'); t.className='title'; t.textContent='‚Ä¶'; front.appendChild(t);
  const kw = document.createElement('div'); kw.className='kw'; kw.textContent=label||''; front.appendChild(kw);
  const shine=document.createElement('div'); shine.className='shine';
  card.appendChild(back); card.appendChild(front); card.appendChild(shine);
  return card;
}
renderEmptySpread();

function topicFromQuestion(q){
  const text = (q||'').toLowerCase();
  for(const k in QUESTIONS){
    if(QUESTIONS[k].some(w=>text.includes(w))) return k;
  }
  return 'general';
}

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  } return arr;
}

function expressiveKeywords(card, topic){
  // Simple topic-aware mapping
  const core = card.upright || card.keywords?.join(', ');
  const tmap = {
    love: { "The Lovers":"Alignment in values ‚Ä¢ Honest choice", "The Devil":"Break toxic loop ‚Ä¢ Reclaim power",
            "The Tower":"Truth clears the path ‚Ä¢ Raw honesty", "The Star":"Heal & receive love" },
    career: { "The Magician":"Pitch skills ‚Ä¢ Act now", "The Chariot":"Disciplined push ‚Ä¢ Win potential",
              "Eight of Pentacles":"Sharpen craft ‚Ä¢ Consistency", "Wheel of Fortune":"Timing favours action" },
    money: { "King of Pentacles":"Build assets ‚Ä¢ Long-term", "Ten of Pentacles":"Family security ‚Ä¢ Legacy",
             "Ace of Swords":"Cut waste ‚Ä¢ Clear plan", "Justice":"Fair deals ‚Ä¢ Due diligence" },
    health: { "Temperance":"Balanced routine ‚Ä¢ Gentle healing", "Strength":"Inner resilience ‚Ä¢ Pace yourself",
              "The Sun":"Vitality boost ‚Ä¢ Joy", "The Moon":"Listen to body signals" },
    spiritual: { "The High Priestess":"Meditate ‚Ä¢ Trust inner voice", "The Hermit":"Retreat & reflect",
                 "Judgement":"Answer soul calling", "Death":"Shed old skin ‚Ä¢ Rebirth" }
  };
  const m = tmap[topic]||{};
  return m[card.name] || core;
}

function layoutFan(cards){
  const spread = document.getElementById('spread');
  const n = cards.length;
  const baseAngle = Math.min(9, 30/n);
  cards.forEach((card, i)=>{
    const angle = (i-(n-1)/2)*baseAngle;
    card.style.transform = `rotate(${angle}deg) translateY(${Math.abs(i-(n-1)/2)*-2}px)`;
    setTimeout(()=> card.style.transform = '', 20); // allow CSS transition snap-in
  });
}

async function drawCards(){
  const q = document.getElementById('question').value.trim();
  const topic = topicFromQuestion(q);
  const spec = SPREADS[currentSpread];
  const spread = document.getElementById('spread');
  const readingBox = document.getElementById('reading');
  const readingText = document.getElementById('readingText');
  readingBox.style.display='none'; readingText.textContent='';

  shuffleSound();
  tryVibrate(30);

  spread.innerHTML='';
  const deck = shuffle([...DECK]);
  const picks = deck.slice(0, spec.count).map(c=>({...c, reversed: Math.random()>.77 }));
  const cards = [];

  for(let i=0;i<picks.length;i++){
    const shell = createCardShell(spec.labels[i]||`Card ${i+1}`);
    spread.appendChild(shell);
    cards.push(shell);
  }

  // fan animation
  layoutFan(cards);

  // Flip in sequence with expressive content
  for(let i=0;i<picks.length;i++){
    await new Promise(r=>setTimeout(r, 250 + i*180));
    flipSound();
    const c = cards[i];
    const card = picks[i];
    const front = c.querySelector('.front');
    const title = front.querySelector('.title');
    const kw = front.querySelector('.kw');
    c.classList.add('flipped');

    const meaning = card.reversed ? (card.reverse||'Block / delay') : expressiveKeywords(card, topic);
    title.textContent = `${card.emoji||''} ${card.name}${card.reversed?' (Rx)':''}`;
    kw.textContent = meaning;

    // sparkles
    const rect = c.getBoundingClientRect();
    sparkAt(document.body, rect.left + rect.width/2, rect.top + 20);
  }

  // Summary (offline or online)
  let summary = offlineSummary(picks, topic, q);
  if(onlineMode){
    const aiText = await tryOnlineAI({question:q, topic, cards:picks});
    if(aiText) summary = aiText + "\n\n‚Äî(fallback-ready: offline available)";
  }
  readingText.textContent = summary;
  readingBox.style.display='block';
}

function offlineSummary(cards, topic, q){
  const pos = ['Focus','Past','Present','Future','Advice','Outcome','Crossing','Hidden','Environment','Hopes'];
  const lines = cards.map((c,i)=> `‚Ä¢ ${pos[i]||'Card'}: ${c.name}${c.reversed?' (Rx)':''} ‚Üí ${expressiveKeywords(c,topic)}`);
  const tone = topic==='love' ? "‚ù§Ô∏è Matters of heart want honesty." :
              topic==='career' ? "üíº Career wants focused action." :
              topic==='money' ? "üí∞ Finances need planning." :
              topic==='health' ? "ü©∫ Health wants balance." :
              topic==='spiritual' ? "üïäÔ∏è Deeper alignment calls." : "‚ú® Trust your path.";
  const qline = q? `Q: ${q}\n` : '';
  return `${qline}${lines.join('\n')}\n\n${tone} Move with awareness, not fear.`;
}

async function tryOnlineAI(payload){
  const url = document.getElementById('apiUrl').value.trim();
  if(!url) return null;
  const key = document.getElementById('apiKey').value.trim();
  try{
    const res = await fetch(url, {
      method:'POST',
      headers:{ 'Content-Type':'application/json', ...(key?{'Authorization':`Bearer ${key}`}:{}) },
      body: JSON.stringify({ intent:'tarot_reading', ...payload })
    });
    if(!res.ok) throw new Error('AI endpoint error');
    const data = await res.json().catch(()=>null);
    // expect {text:"..."} or similar
    const text = data?.text || data?.message || (typeof data==='string'?data:null);
    setApiStatus('AI response received ‚úÖ'); chord([392,523,659],.18);
    return text;
  }catch(e){
    setApiStatus('AI request failed (CORS/network). Using offline summary.'); ping(220,.12,'sine',.15);
    return null;
  }
}

document.getElementById('drawBtn').addEventListener('click', drawCards);
document.getElementById('resetBtn').addEventListener('click', ()=>{
  renderEmptySpread();
  const reading = document.getElementById('reading');
  if(reading){ reading.style.display='none'; }
  chord([330,392],.14);
});

/* ========= NUMEROLOGY ========= */
const PNUM = { a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9, j:1,k:2,l:3,m:4,n:5,o:6,p:7,q:8,r:9, s:1,t:2,u:3,v:4,w:5,x:6,y:7,z:8 };
const VOWELS = new Set(['a','e','i','o','u','y']); // y sometimes
function lettersOnly(s){ return (s||'').toLowerCase().replace(/[^a-z]/g,'') }
function sumDigits(n){ n=Math.abs(Number(n)||0); while(n>9 && ![11,22,33].includes(n)){ n= String(n).split('').reduce((a,b)=>a+Number(b),0) } return n }
function fullReduce(n){ n=Math.abs(Number(n)||0); while(n>9 && ![11,22,33].includes(n)){ n= String(n).split('').reduce((a,b)=>a+Number(b),0) } return n }
function dateToNums(d){
  const dt = new Date(d); if(isNaN(dt)) return null;
  return { day:dt.getDate(), month:dt.getMonth()+1, year:dt.getFullYear() }
}
function calcLifePath(d){ const n = dateToNums(d); if(!n) return null;
  return fullReduce(fullReduce(n.day)+fullReduce(n.month)+fullReduce(n.year));
}
function calcExpression(name){
  const str = lettersOnly(name); let t=0; for(const ch of str){ t+= (PNUM[ch]||0) } return fullReduce(t);
}
function calcSoulUrge(name){
  const str = lettersOnly(name); let t=0; for(const ch of str){ if(VOWELS.has(ch)) t+=PNUM[ch]||0 } return fullReduce(t);
}
function calcPersonality(name){
  const str = lettersOnly(name); let t=0; for(const ch of str){ if(!VOWELS.has(ch)) t+=PNUM[ch]||0 } return fullReduce(t);
}
function calcBirthday(d){ const n = dateToNums(d); if(!n) return null; return fullReduce(n.day) }
function calcMaturity(life, expression){ if(!life||!expression) return null; return fullReduce(life+expression) }
function karmicDebts(name){
  const str = lettersOnly(name);
  const K = {13:false,14:false,16:false,19:false};
  // crude: check if any name reduces exactly to these at word-level
  const words = (name||'').toLowerCase().split(/\s+/).filter(Boolean);
  words.forEach(w=>{
    let t=0; for(const ch of lettersOnly(w)){ t+=PNUM[ch]||0 }
    const r = fullReduce(t);
    if([13,14,16,19].includes(r)) K[r]=true;
  });
  return Object.entries(K).filter(([k,v])=>v).map(([k])=>Number(k));
}
function balanceNumber(name){
  // Take first letters of each name part
  const parts = (name||'').toLowerCase().split(/\s+/).filter(Boolean);
  let t=0; parts.forEach(p=>{ const ch = p[0]; if(PNUM[ch]) t+=PNUM[ch] });
  return t?fullReduce(t):null;
}
function personalYear(dob, dateRef=new Date()){
  const n = dateToNums(dob); if(!n) return null;
  const y = dateRef.getFullYear();
  return fullReduce(fullReduce(n.day)+fullReduce(n.month)+fullReduce(y));
}
function pinnacles(dob){
  const n = dateToNums(dob); if(!n) return null;
  const rDay = fullReduce(n.day), rMonth=fullReduce(n.month), rYear=fullReduce(n.year);
  const P1 = fullReduce(rMonth + rDay);
  const P2 = fullReduce(rDay + rYear);
  const P3 = fullReduce(P1 + P2);
  const P4 = fullReduce(rMonth + rYear);
  return {P1,P2,P3,P4};
}
function challenges(dob){
  const n = dateToNums(dob); if(!n) return null;
  const c1 = Math.abs(fullReduce(n.month) - fullReduce(n.day));
  const c2 = Math.abs(fullReduce(n.day) - fullReduce(n.year));
  const c3 = Math.abs(c1 - c2);
  const c4 = Math.abs(fullReduce(n.month) - fullReduce(n.year));
  return {C1:c1, C2:c2, C3:c3, C4:c4};
}
function luckyElementsFromLife(life){
  const map={
    1:{color:"Gold, Red", day:"Sunday", stone:"Ruby", element:"Fire"},
    2:{color:"White, Cream", day:"Monday", stone:"Pearl", element:"Water"},
    3:{color:"Yellow", day:"Thursday", stone:"Yellow Sapphire", element:"Air"},
    4:{color:"Blue, Black", day:"Saturday", stone:"Gomed/Onyx", element:"Earth"},
    5:{color:"Green", day:"Wednesday", stone:"Emerald", element:"Air"},
    6:{color:"Pink, Pastel", day:"Friday", stone:"Diamond", element:"Earth"},
    7:{color:"Violet", day:"Monday/Thursday", stone:"Amethyst", element:"Water"},
    8:{color:"Dark Blue", day:"Saturday", stone:"Blue Sapphire", element:"Earth"},
    9:{color:"Red", day:"Tuesday", stone:"Coral", element:"Fire"},
    11:{color:"Silver/Blue", day:"Friday", stone:"Aquamarine", element:"Water"},
    22:{color:"Earth tones", day:"Saturday", stone:"Lapis", element:"Earth"},
    33:{color:"Rose/Gold", day:"Friday", stone:"Rose Quartz", element:"Fire"}
  };
  return map[life]||map[fullReduce(life||0)]||{color:"‚Äî",day:"‚Äî",stone:"‚Äî",element:"‚Äî"};
}

function renderNumResult(title, content){
  const box = document.createElement('div'); box.className='result';
  const h = document.createElement('h4'); h.textContent=title; box.appendChild(h);
  const p = document.createElement('p'); p.innerHTML = content;
  box.appendChild(p); return box;
}

document.getElementById('calcNum').addEventListener('click', ()=>{
  const name = document.getElementById('fullName').value.trim();
  const dob = document.getElementById('dob').value;
  const out = document.getElementById('numResults'); out.innerHTML='';
  if(!name || !dob){ out.appendChild(renderNumResult('Error', '<span class="err">Please enter full name and date of birth.</span>')); ping(220,.15); return; }

  const life = calcLifePath(dob);
  const expr = calcExpression(name);
  const soul = calcSoulUrge(name);
  const pers = calcPersonality(name);
  const bday = calcBirthday(dob);
  const matur = calcMaturity(life,expr);
  const debts = karmicDebts(name);
  const bal = balanceNumber(name);
  const pYear = personalYear(dob);
  const pins = pinnacles(dob);
  const chals = challenges(dob);

  out.appendChild(renderNumResult('Life Path', `<b>${life}</b> ‚Äî Your core journey.`));
  out.appendChild(renderNumResult('Expression (Destiny)', `<b>${expr}</b> ‚Äî Talents & natural gifts.`));
  out.appendChild(renderNumResult('Soul Urge (Heart\'s Desire)', `<b>${soul}</b> ‚Äî Inner motivation.`));
  out.appendChild(renderNumResult('Personality', `<b>${pers}</b> ‚Äî Outer impression.`));
  out.appendChild(renderNumResult('Birthday Number', `<b>${bday}</b> ‚Äî Specific trait.`));
  out.appendChild(renderNumResult('Maturity', `<b>${matur}</b> ‚Äî Late-life expression.`));
  out.appendChild(renderNumResult('Karmic Debts', debts.length? `<b>${debts.join(', ')}</b>` : 'None prominent.'));
  out.appendChild(renderNumResult('Balance Number', bal? `<b>${bal}</b>`:'‚Äî'));
  out.appendChild(renderNumResult('Personal Year (Current)', `<b>${pYear}</b> ‚Äî Theme for this year.`));
  out.appendChild(renderNumResult('Pinnacles', `P1: <b>${pins.P1}</b> ‚Ä¢ P2: <b>${pins.P2}</b> ‚Ä¢ P3: <b>${pins.P3}</b> ‚Ä¢ P4: <b>${pins.P4}</b>`));
  out.appendChild(renderNumResult('Challenges', `C1: <b>${chals.C1}</b> ‚Ä¢ C2: <b>${chals.C2}</b> ‚Ä¢ C3: <b>${chals.C3}</b> ‚Ä¢ C4: <b>${chals.C4}</b>`));

  const lucky = luckyElementsFromLife(life);
  const luckyBox = document.getElementById('luckyBox');
  const luckyText = document.getElementById('luckyText');
  luckyText.innerHTML = `Colors: <b>${lucky.color}</b> ‚Ä¢ Day: <b>${lucky.day}</b> ‚Ä¢ Stone: <b>${lucky.stone}</b> ‚Ä¢ Element: <b>${lucky.element}</b>`;
  luckyBox.style.display='block';

  chord([523,659,784],.22);
});

document.getElementById('resetNum').addEventListener('click', ()=>{
  document.getElementById('fullName').value='';
  document.getElementById('dob').value='';
  document.getElementById('numResults').innerHTML='';
  document.getElementById('luckyBox').style.display='none';
  chord([330,392],.14);
});

/* ========= ASTRO (Lite) ========= */
const SUN_SIGNS = [
  {name:'Aries', start:'03-21', end:'04-19'},
  {name:'Taurus', start:'04-20', end:'05-20'},
  {name:'Gemini', start:'05-21', end:'06-20'},
  {name:'Cancer', start:'06-21', end:'07-22'},
  {name:'Leo', start:'07-23', end:'08-22'},
  {name:'Virgo', start:'08-23', end:'09-22'},
  {name:'Libra', start:'09-23', end:'10-22'},
  {name:'Scorpio', start:'10-23', end:'11-21'},
  {name:'Sagittarius', start:'11-22', end:'12-21'},
  {name:'Capricorn', start:'12-22', end:'01-19'},
  {name:'Aquarius', start:'01-20', end:'02-18'},
  {name:'Pisces', start:'02-19', end:'03-20'},
];
function sunSign(dob){
  const d = new Date(dob); if(isNaN(d)) return null;
  const m = (d.getMonth()+1).toString().padStart(2,'0');
  const day = d.getDate().toString().padStart(2,'0');
  const md = `${m}-${day}`;
  for(const s of SUN_SIGNS){
    if(s.start<=s.end){
      if(md>=s.start && md<=s.end) return s.name;
    }else{
      if(md>=s.start || md<=s.end) return s.name;
    }
  }
  return null;
}
function simpleDashaLike(dob){
  // Not real Vedic dashas‚Äîjust a symbolic 9-cycle (Sun..Ketu style) over 9*7=63 years window
  const planets = ['Sun','Moon','Mars','Rahu','Jupiter','Saturn','Mercury','Ketu','Venus'];
  const dur = [6,10,7,18,16,19,17,7,20]; // not accurate; symbolic only
  const base = new Date(dob); if(isNaN(base)) return [];
  let year = base.getFullYear(), m=base.getMonth(), d=base.getDate();
  const out=[]; for(let i=0;i<9;i++){
    const start = new Date(year,m,d);
    const end = new Date(start); end.setFullYear(end.getFullYear()+dur[i]);
    out.push({lord:planets[i], from:start.toDateString(), to:end.toDateString()});
    year = end.getFullYear(); m=end.getMonth(); d=end.getDate();
  }
  return out;
}

document.getElementById('calcAstro').addEventListener('click', ()=>{
  const dob = document.getElementById('astroDob').value;
  const out = document.getElementById('astroResults'); out.innerHTML='';
  if(!dob){ out.appendChild(renderNumResult('Error','<span class="err">Please enter DOB.</span>')); ping(220,.15); return; }
  const sun = sunSign(dob) || '‚Äî';
  const pYear = personalYear(dob);
  const dasha = simpleDashaLike(dob);

  out.appendChild(renderNumResult('Sun Sign', `<b>${sun}</b>`));
  out.appendChild(renderNumResult('Personal Year (Numerology)', `<b>${pYear}</b> ‚Äî Yearly theme.`));

  const dbox = document.createElement('div'); dbox.className='result';
  const h = document.createElement('h4'); h.textContent='Dasha-style Timeline (Simplified ‚Äî not actual Vedic)'; dbox.appendChild(h);
  const p = document.createElement('p'); p.className='small muted'; p.textContent='For real Vedic dashas, use an ephemeris API/server.'; dbox.appendChild(p);
  dasha.forEach(row=>{
    const line = document.createElement('p'); line.innerHTML=`‚Ä¢ <b>${row.lord}</b> ‚Äî ${row.from} ‚Üí ${row.to}`;
    dbox.appendChild(line);
  });
  out.appendChild(dbox);
  chord([523,587,659],.2);
});
document.getElementById('resetAstro').addEventListener('click', ()=>{
  document.getElementById('astroDob').value='';
  document.getElementById('astroTime').value='';
  document.getElementById('astroPlace').value='';
  document.getElementById('astroResults').innerHTML='';
  chord([330,392],.14);
});

/* ========= Init: Button hover sparkles ========= */
document.querySelectorAll('.btn, .ghost').forEach(el=>{
  el.addEventListener('pointerenter', (e)=>{
    const rect = el.getBoundingClientRect();
    sparkAt(el, rect.width*Math.random(), rect.height*.2);
    ping(880,.06,'sine',.05);
  });
});
</script>
</body>
</html>
